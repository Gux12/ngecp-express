<!doctype html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="zh-CH">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/animate-animo.min.css">
    <link rel="stylesheet" href="css/buttons.min.css">
    <!-- <link rel="stylesheet" href="css/jquery-ui.css"> -->
    <link rel="stylesheet" href="css/flat-ui.css">
    <!-- <link rel="stylesheet" href="css/select2.min.css"> -->
    <link rel="stylesheet" href="css/font-awesome.css">
    <!-- <link rel="stylesheet" href="css/lightbox.css"> -->
    <link rel="stylesheet" href="css/main.css">
    <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
</head>

<body>
    <!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->
    <div class="header"></div>
    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="container-fluid" style="text-align: left;margin-top: 53px;" id='bb'>
        <!--         <div class="row">
            <canvas id="c" height="100" width="100" style="position: relative;"></canvas>
        </div> -->
        <div class="row">
            <div class="col-md-12">
                <h4 style="text-align: center" class="animated fadeIn" id="auto">自动生成供应链中...ヽ(•̀ω•́ )ゝ</h4>
            </div>
        </div>
        <div class="row">
            <div class="col-md-3 smart-chain" id="smart-chain1">
                <div class="guxblock">
                    <div class="row">
                        <p style="text-align: center" id='chainhead1' class="font-gray">设计师</p>
                        <select multiple="multiple" class="form-control multiselect multiselect-info col-md-12">
                            <option value="黄亚东" selected>黄亚东</option>
                            <option value="南艺璇">南艺璇</option>
                            <option value="顾乡">顾乡</option>
                            <option value="徐扬">徐扬</option>
                            <option value="孙骁">孙骁</option>
                            <option value="王瓅">王瓅</option>
                        </select>
                    </div>
                    <hr style="border-top: 2px solid #666666;">
                    <div class="chart">
                    </div>
                </div>
            </div>
            <div class="col-md-3 smart-chain" id="smart-chain2">
                <div class="guxblock">
                    <div class="row">
                        <p style="text-align: center" id='chainhead2' class="font-gray">生产商</p>
                        <select multiple="multiple" class="form-control multiselect multiselect-info">
                            <option value="北京服装制造厂" selected>北京服装制造厂</option>
                            <option value="丰台服装制造厂">丰台服装制造厂</option>
                            <option value="大红门服装制造厂">大红门服装制造厂</option>
                            <option value="动物园服装制造厂">动物园服装制造厂</option>
                            <option value="房山服装制造厂">房山服装制造厂</option>
                            <option value="顺义服装制造厂">顺义服装制造厂</option>
                        </select>
                    </div>
                    <hr style="border-top: 2px solid #666666;">
                    <div class="chart">
                    </div>
                </div>
            </div>
            <div class="col-md-3 smart-chain" id="smart-chain3">
                <div class="guxblock">
                    <div class="row">
                        <p style="text-align: center" id='chainhead3' class="font-gray">集散中心</p>
                        <select multiple="multiple" class="form-control multiselect multiselect-info">
                            <option value="5号仓" selected>5号仓</option>
                            <option value="鲁谷集散中心">鲁谷集散中心</option>
                            <option value="六里桥集散中心">六里桥集散中心</option>
                            <option value="四惠集散中心">四惠集散中心</option>
                            <option value="上地集散中心">上地集散中心</option>
                            <option value="三元桥集散中心">三元桥集散中心</option>
                        </select>
                    </div>
                    <hr style="border-top: 2px solid #666666;">
                    <div class="chart">
                    </div>
                </div>
            </div>
            <div class="col-md-3 smart-chain" id="smart-chain4">
                <div class="guxblock">
                    <div class="row">
                        <p style="text-align: center" id='chainhead4' class="font-gray">配送服务商</p>
                        <select multiple="multiple" class="form-control multiselect multiselect-info">
                            <option value="顺丰" selected>顺丰</option>
                            <option value="申通">申通</option>
                            <option value="中通">中通</option>
                            <option value="圆通">圆通</option>
                            <option value="德邦">德邦</option>
                            <option value="韵达">韵达</option>
                        </select>
                    </div>
                    <hr style="border-top: 2px solid #666666;">
                    <div class="chart">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h1 style="text-align: center"><a id="enter" class="button button-glow button-rounded button-jumbo button-action hide">确认订单</a></h1>
            </div>
        </div>
    </div>
    </div>
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <div class="modal-title font-gray" id="myModalLabel" style="text-align:center;">
                        <div id='map' style="width:100%;height:500px"></div>
                    </div>
                </div>
                <div class="modal-body" id='mymodalbody'></div>
                <div class="modal-footer">
                    <a class="btn btn-inverse btn-block" href="/3Dmodels/cloth1">查看详情</a>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal -->
    </div>
    <script src="js/vendor/jquery-1.11.2.min.js"></script>
    <!-- <script src="js/jquery-2.1.1.js"></script> -->
    <script src="js/vendor/animo.min.js"></script>
    <script src="js/vendor/flat-ui.js"></script>
    <script src="js/vendor/select2.full.min.js"></script>
    <!-- <script src="js/vendor/lightbox.js"></script> -->
    <script src="js/main.js"></script>
    <script src="js/vendor/echarts.min.js"></script>
    <script>
    jQuery(document).ready(function($) {
        // 这部分是动态供应链的页面smart_chain.html相关的代码

        function animateAllChain(pos, callback) {
            $('#smart-chain' + pos).show();
            if ($('#smart-chain' + pos).length) {
                $('#smart-chain' + pos).animo({
                    animation: 'fadeInLeft',
                    duration: 1,
                    timing: "easy-in"
                }, function() {
                    animateAllChain(pos + 1, callback);
                });
            } else {
                callback();
            }
        }

        function fadeAllChain(pos, callback) {
            $('#smart-chain' + pos).show();
            if ($('#smart-chain' + pos).length) {
                $('#smart-chain' + pos).animo({
                        animation: 'fadeOut',
                        duration: 0.5,
                        timing: "easy-in",
                        keep: true
                    },
                    function() {
                        fadeAllChain(pos + 1, callback)
                    }
                );
            } else {
                callback();
            }
        }
        animateAllChain(1, function() {
            $('#auto').animo({
                animation: 'fadeOutUp',
                duration: 1,
                timing: "easy-in",
                keep: true
            });
            $('#enter').removeClass('hide');

        });
        $('#enter').click(function(event) {
            /* Act on the event */
            flag = 0;
            for (var i = 1; i <= 4; i++) {
                buf = $('#smart-chain' + i).find('select').val();
                if (buf)
                    if (buf.length != 1) {
                        flag = 1;
                    }

            }
            if (flag) {
                flag = 0;
                $(this).popover({
                    animation: true,
                    content: '供应链不完整或有冗余',
                    title: '警告',
                    placement: 'top'
                })
            } else {
                buf = [];
                for (var i = 1; i <= 4; i++) {
                    buf.push($('#smart-chain' + i).find('select').val());
                }
                fadeAllChain(1, function() {
                    $('.smart-chain').hide();
                    $('#enter').hide();
                    $('#bb').append('<div class="col-md-4 col-md-offset-4"><div class="guxblock-move"><p style="text-align: center" class="font-gray">' + $('#chainhead1')[0].innerText + '：' + buf[0] + '</p><p style="text-align: center" class="font-gray">' + $('#chainhead2')[0].innerText + '：' + buf[1] + '</p><p style="text-align: center" class="font-gray">' + $('#chainhead3')[0].innerText + '：' + buf[2] + '</p><p style="text-align: center" class="font-gray">' + $('#chainhead4')[0].innerText + '：' + buf[3] + '</p><p style="text-align: center" class="font-gray">动态成交价：98￥</p><button class="button button-primary button-rounded" style="width: 49%;margin-top: 20px;">查看订单</button> <button onclick="window.location.href=' + "'product_info.html'" + '" class="button button-highlight button-rounded" style="width: 49%;margin-top: 10px;">继续购物</button></div></div>')
                })
            }
        });
        $(".multiselect").select2({
            dropdownCssClass: 'dropdown-inverse',
        });
        $('.chart').width($('.chart').width());
        $('.chart').css('height', 400);
        var myChart1 = echarts.init($('#smart-chain1 .chart')[0]);
        var myChart2 = echarts.init($('#smart-chain2 .chart')[0]);
        var myChart3 = echarts.init($('#smart-chain3 .chart')[0]);
        var myChart4 = echarts.init($('#smart-chain4 .chart')[0]);
        data1 = [];
        data2 = [];
        data3 = [];
        data4 = [];
        $(".multiselect").each(function(event) {
            /* Act on the event */
            text = $(this).parents('.smart-chain')[0].id;
            var value = text.replace(/[^0-9]/ig, "");
            buf = $(this).val();
            for (var i = buf.length - 1; i >= 0; i--) {
                arr = [];
                for (var j = 0; j < 5; j++)
                    arr.push(parseInt(Math.random() * (100 - 60 + 1) + 60));
                eval('data' + value).push({
                    value: arr,
                    name: buf[i]
                });
            }
        });
        $(".multiselect").change(function(event) {
            /* Act on the event */
            text = $(this).parents('.smart-chain')[0].id;
            var value = text.replace(/[^0-9]/ig, "");
            data = [];
            buf = $(this).val();
            if (buf) {
                for (var i = buf.length - 1; i >= 0; i--) {
                    arr = [];
                    for (var j = 0; j < 5; j++)
                        arr.push(parseInt(Math.random() * (100 - 60 + 1) + 60));
                    data.push({
                        value: arr,
                        name: buf[i]
                    });
                }
                data_name = [];
                for (var j = data.length - 1; j >= 0; j--) {
                    data_name[j] = data[j].name;
                }
            } else {
                data = [];
                data_name = [];
            }

            option = {
                title: {
                    subtext: '评价参数对比'
                },
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    x: 'center',
                    data: data_name
                },
                toolbox: {
                    show: true,
                    feature: {
                        mark: {
                            show: true
                        },
                        saveAsImage: {
                            show: true
                        }
                    }
                },
                calculable: true,
                polar: [{
                    indicator: [{
                        text: '价格',
                        max: 100
                    }, {
                        text: '速度',
                        max: 100
                    }, {
                        text: '信用',
                        max: 100
                    }, {
                        text: '质量',
                        max: 100
                    }, {
                        text: '销量',
                        max: 100
                    }],
                    radius: 130 * $('.chart').width() / 400
                }],
                series: [{
                    name: '评价参数对比',
                    type: 'radar',
                    itemStyle: {
                        normal: {
                            areaStyle: {
                                type: 'default'
                            }
                        }
                    },
                    data: data
                }]
            };
            eval('myChart' + value).clear();
            eval('myChart' + value).setOption(option);
        });
        for (var i = 1; i <= 4; i++) {
            data_name = [];
            for (var j = eval('data' + i).length - 1; j >= 0; j--) {
                data_name[j] = eval('data' + i)[j].name;
            }
            option = {
                title: {
                    subtext: '评价参数对比'
                },
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    x: 'center',
                    data: data_name
                },
                toolbox: {
                    show: true,
                    feature: {
                        mark: {
                            show: true
                        },
                        saveAsImage: {
                            show: true
                        }
                    }
                },
                calculable: true,
                polar: [{
                    indicator: [{
                        text: '价格',
                        max: 100
                    }, {
                        text: '速度',
                        max: 100
                    }, {
                        text: '信用',
                        max: 100
                    }, {
                        text: '质量',
                        max: 100
                    }, {
                        text: '销量',
                        max: 100
                    }],
                    radius: 130 * $('.chart').width() / 400
                }],
                series: [{
                    name: '评价参数对比',
                    type: 'radar',
                    itemStyle: {
                        normal: {
                            areaStyle: {
                                type: 'default'
                            }
                        }
                    },
                    data: eval('data' + i)
                }]
            };
            eval('myChart' + i).setOption(option);
        }
    });
    </script>
    <script>
    $(document).ready(function() {
        $('.select2-search-choice').on('contextmenu', function(event) {
            value = $(this).children('div')[0].innerText;
            $('.contextmenu1').remove();
            this.oncontextmenu = null;
            event.preventDefault();
            $('body').append('<ul class="contextmenu1" style="padding:5px;border:3px solid #eee;box-shadow: 10px 10px 3px #888888;font-size:14px;background:white;display:block;top:' + event.clientY + 'px;left:' + event.clientX + 'px;position:absolute;z-index:4000;"><a onclick="BaiduDiTu(map1,' + "'" + value + "'" + ')" data-toggle="modal" data-target="#myModal" style="cursor:pointer">查看地址</a><br><a href="/3Dmodels/cloth1">查看厂房</a><br><a href="/3Dmodels/cloth2">查看流水线</a><br></ul>');
        });
        document.onclick = function() {
            $('.contextmenu1').remove();
        };
        $(".multiselect").change(function(event) {
            $('.select2-search-choice').on('contextmenu', function(event) {
                value = $(this).children('div')[0].innerText;
                $('.contextmenu1').remove();
                this.oncontextmenu = null;
                event.preventDefault();
                $('body').append('<ul class="contextmenu1" style="padding:5px;border:3px solid #eee;box-shadow: 10px 10px 3px #888888;font-size:14px;background:white;display:block;top:' + event.clientY + 'px;left:' + event.clientX + 'px;position:absolute;z-index:4000;"><a onclick="BaiduDiTu(map1,' + "'" + value + "'" + ')" data-toggle="modal" data-target="#myModal" style="cursor:pointer">查看地址</a><br><a href="/3Dmodels/cloth1">查看厂房</a><br><a href="/3Dmodels/cloth2">查看流水线</a><br></ul>');
            });
        });
    });
    </script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=XRC0hIYvB73wvsTGOH4ETyCx"></script>
    <script type="text/javascript">
    // 百度地图API功能
    var map1 = new BMap.Map('map');
    map1.centerAndZoom(new BMap.Point(116.4, 39.9), 12);
    map1.setCurrentCity("北京");
    map1.addControl(new BMap.MapTypeControl());
    map1.enableScrollWheelZoom(true);

    function BaiduDiTu(map, name) {
        // $('#myModalLabel')[0].innerText = name;
        // $('#mymodalbody').append('<div id=' + name + ' style="width:100%;height:500px"></div>');

        map1.centerAndZoom(new BMap.Point(116.4, 39.9), 12);
        var local = new BMap.LocalSearch(map, {
            renderOptions: {
                map: map
            }
        });
        local.clearResults();
        local.search(name);
    }
    </script>
</body>

</html>
