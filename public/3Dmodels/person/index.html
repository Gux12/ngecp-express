<!DOCTYPE HTML>
<html>
<script type="text/javascript">
var isBuilderMode = false;
var ResizePolicy = 3;
</script>

<head>
    <title>New Project-EMP.VRP3D.COM</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=0'>
    <meta name="apple-touch-fullscreen" content="YES">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script src="../js/jquery-1.11.3.min.js" type="text/javascript"></script>
    <script src="../js/three.js"></script>
    <script src="../js/TrackballControls.min.js" type="text/javascript"></script>
    <script src="../js/JsonIndexLoader.js"></script>
    <script src="../js/empBuilder.min.js" type="text/javascript"></script>
    <script src="../js/empRuntime.min.js" type="text/javascript"></script>
    <script src="../js/animo.min.js" type="text/javascript"></script>
    <script src="../js/stats.min.js" type="text/javascript"></script>
    <script src="../js/Detector.min.js" type="text/javascript"></script>
    <script src="../js/Tween.min.js" type="text/javascript"></script>
    <link href="../js/animate-animo.css" rel="stylesheet" type="text/css">
    <script src="../js/jgestures.min.js" type="text/javascript"></script>
    <script src="../js/pageSwitch.min.js" type="text/javascript"></script>
</head>

<body style="position:absolute;  background-color:rgba(255,255,255,0);background-size:100% 100%;background-repeat:no-repeat; background-attachment:fixed; margin-top: 0px;margin-bottom: 0px;margin-left: 0px;margin-right: 0px;-webkit-touch-callout:none;-webkit-user-select:none;">
    <script src="/socket.io/socket.io.js"></script>
</body>

</html>
<script type="text/javascript">
var winFixWidth = document.body.scrollWidth,
    winFixHeight = document.body.scrollHeight;
</script>
<script type="text/javascript">
var EmpFirstShowPage = {
    'pages': ['328025549-555962254-2129857797-1769827767', 'END'],
    'first': 0
};
var PageInitFunc = {};
var PageExitFunc = {};

window.addEventListener("load", (function() {
    if (PageInitFunc['328025549-555962254-2129857797-1769827767']) PageInitFunc['328025549-555962254-2129857797-1769827767']();
}), false);
</script>
<script type="text/javascript">
(function() { /* page:  汽车展示合_1 */
    var pageElement = empGetElementByID('328025549-555962254-2129857797-1769827767', 'div', null);
    pageElement.style.cssText = "background-color:rgba(138,0,0,0);position:absolute;margin:0px 0px 0px 0px;  z-index: 1;overflow:hidden;display:none;" + "width:" + document.body.scrollWidth + "px;height:" + document.body.scrollHeight + "px;";
    PageInitFunc['328025549-555962254-2129857797-1769827767'] = (function() { /*empShowElementByID('1421555384-1552117900-707152488-937763923', 'hidden');  empShowElementByID('1691582227-1485258816-650407005-2039880589', 'visible');  empShowElementByID('513083203-513561875-706164739-1153835674', 'hidden');*/
        _124324387819802023771476550153307121760.enable();
    });
    PageExitFunc['328025549-555962254-2129857797-1769827767'] = (function() {
        _124324387819802023771476550153307121760.disable();
    });
})();

(function() { /*  3DScene:  3D场景_1  */
    var pageElement213 = empGetElementByID('328025549-555962254-2129857797-1769827767', 'div', null);
    var itemElement = empGetElementByID('1243243878-1980202377-1476550153-307121760', 'div', pageElement213);
    pageElement213.appendChild(itemElement);
    itemElement.style.cssText = "pointer-events:auto;position:absolute;left:0px;top:0px;opacity:1;transform-origin:50% 50%;-webkit-transform-origin:50% 50%;-moz-transform-origin:50% 50%;-o-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform:translate(0px,0px) rotate(0deg) skew(0deg,0deg) scale(1,1);  z-index:8;" + "width:" + document.body.scrollWidth + "px;height:" + document.body.scrollHeight + "px;";
})();
var _124324387819802023771476550153307121760 = create3dScene('1243243878-1980202377-1476550153-307121760', 1024, 1024, 0xffffff, 0);
if (_124324387819802023771476550153307121760) {
    (function() {
        //car1 23,0,0  47,13,33
        //car2     8015,6463,9381
        var EmpCamera = _124324387819802023771476550153307121760.camera;
        EmpCamera.fov = 45;
        EmpCamera.near = 1;
        EmpCamera.far = 10000;
        EmpCamera.position.set(-12.5, 75.6, 367.7);
        EmpCamera.lookAt(0, 120, 0);
        EmpCamera.up.set(0, 1, 0);
        _124324387819802023771476550153307121760.controls.target.set(0, 120, 0);
        _124324387819802023771476550153307121760.controls.minDistance = 100;
        _124324387819802023771476550153307121760.controls.maxDistance = 10000;
        EmpCamera.updateProjectionMatrix();
    })();

    _124324387819802023771476550153307121760.loadEmpObjs('tsinghua2_ani/index.js', 'cloth', '', {
        computNormal: true,
        autoPlay: false,
        autoLookAtCenter: true
    },function() {
            showModel('woman','big','white');
     });

    (function() {
        var defaultLight = _124324387819802023771476550153307121760.findObjectByName('_1433554002181051684713614094411073901394');
        if (!defaultLight) {
            defaultLight = new THREE.AmbientLight(0xffffff);
            defaultLight.name = '_1433554002181051684713614094411073901394';
            _124324387819802023771476550153307121760.addObject(defaultLight);
        } else {
            defaultLight.color.set(0xffffff);
        }
        defaultLight.visible = true;
    })();
    (function() {
        var defaultLight = _124324387819802023771476550153307121760.findObjectByName('_1413231199170667129609714301060068242');
        if (!defaultLight) {
            defaultLight = new THREE.DirectionalLight(0xffffff, 0.5);
            defaultLight.name = '_1413231199170667129609714301060068242';
            _124324387819802023771476550153307121760.addObject(defaultLight);
        } else {
            defaultLight.color.set(0xffffff);
            defaultLight.intensity = 0.7;
        }
        defaultLight.visible = true;

    })();
    _124324387819802023771476550153307121760.showSkybox(false);

    var sexName = 'man',
        sizeName = 'big',
        colorName = 'red';
    var modelname = {
        'man': {
            'big': {
                'white': 'Mesh12',
                'blue': 'Mesh16',
                'red': 'Mesh09'
            },
            'mid': {
                'white': 'Mesh14',
                'blue': 'Mesh15',
                'red': 'Mesh11'
            },
            'small': {
                'white': 'Mesh13',
                'blue': 'Mesh17',
                'red': 'Mesh10'
            }
        },
        'woman': {
            'big': {
                'white': 'Mesh24,Mesh25,Mesh26',
                'blue': 'Mesh33,Mesh34,Mesh35',
                'red': 'Mesh36,Mesh37,Mesh38'
            },
            'mid': {
                'white': 'Mesh18,Mesh19,Mesh23',
                'blue': 'Mesh32,Mesh33,Mesh34',
                'red': 'Mesh39,Mesh40,Mesh41'
            },
            'small': {
                'white': 'Mesh20,Mesh21,Mesh22',
                'blue': 'Mesh27,Mesh28,Mesh29',
                'red': 'Mesh42,Mesh43,Mesh44'
            }
        },

    };

    function showModel(gender, size, color) {
        _124324387819802023771476550153307121760.showModelByName('EMPALLMODEL', false);
        var buf = modelname[gender][size][color];
        var str = buf.split(",");
        for (key in str) {
            var name = str[key];
            var obj = _124324387819802023771476550153307121760.findObjectByName(name);
            if (obj)
                obj.visible = true;
        }
    }

} /*addChildrenItems end*/

var socket = io();
socket.on('chat message', function(msg) {
    $('#messages').append($('<li>').text(msg));
});
socket.on('chat message', function(msg) {
    $('#messages').append($('<li>').text(msg));
});

socket.on('change sth', function(msg) {
    showModel(msg.gender, msg.size, msg.color);
});
</script>
