var EmpGlobalZoom=1,EmpGlobalLeft=0,EmpGlobalTop=0;function EmpAutoBodySize(){if(!isBuilderMode){var a=0,b=0,c=1,d=window.innerWidth,f=window.innerHeight;3==ResizePolicy?f>=winFixHeight&&d>=winFixWidth?(a=toInt((d-winFixWidth)/2),b=toInt((f-winFixHeight)/2),c=1):d/f>winFixWidth/winFixHeight?(c=f/winFixHeight,a=toInt((d-winFixWidth*c)/2)):(c=d/winFixWidth,b=toInt((f-winFixHeight*c)/2)):1==ResizePolicy?d>=winFixWidth?(c=1,a=toInt((d-winFixWidth)/2),b=toInt((f-winFixHeight)/2)):(c=d/winFixWidth,b=toInt((f-winFixHeight*c)/2),0>b&&(b=0),a=0):2==ResizePolicy?f>=winFixHeight?(c=1,a=toInt((d-winFixWidth)/2),b=toInt((f-winFixHeight)/2)):(c=f/winFixHeight,b=0,a=toInt((d-winFixWidth*c)/2)):(c=1,a=toInt((d-winFixWidth)/2),b=toInt((f-winFixHeight)/2),0>b&&(b=0),0>a&&(a=0));-1!==navigator.userAgent.indexOf("Firefox")?(document.body.style.left=a+"px",document.body.style.top=b+"px",document.body.style.MozTransformOrigin="top left",document.body.style.MozTransform="scale("+c+")"):-1!==navigator.userAgent.indexOf("Trident")||-1!==navigator.userAgent.indexOf("MSIE")?(document.body.style.left=toInt(a)+"px",document.body.style.top=toInt(b)+"px",document.body.style.zoom=c,EmpGlobalZoom=1,EmpGlobalLeft=toInt(a),EmpGlobalTop=toInt(b)):(document.body.style.left=toInt(a/c)+"px",document.body.style.top=toInt(b/c)+"px",EmpGlobalZoom=document.body.style.zoom=c,EmpGlobalLeft=toInt(a/c),EmpGlobalTop=toInt(b/c))}}function cancelTrans(a){a=a?a:window.event;window.event?a.cancelBubble=!0:a.stopPropagation()}function EmpDetectZoom(){var a=0,b=window.screen,c=navigator.userAgent.toLowerCase();void 0!==window.devicePixelRatio?a=window.devicePixelRatio:~c.indexOf("msie")?b.deviceXDPI&&b.logicalXDPI&&(a=b.deviceXDPI/b.logicalXDPI):void 0!==window.outerWidth&&void 0!==window.innerWidth&&(a=window.outerWidth/window.innerWidth);return a}function EmpGetSelfUrl(a){var b=window.location.href.split("?");if(2!=b.length)return"";for(var c in b[1]){var d=b[1].split("\x26"),f;for(f in d){var l=d[c].split("\x3d");if(l&&l[0]==a)return l[1]}}return""}var EmpSortBy=function(a){return function(b,c){var d,f;if("object"===typeof b&&"object"===typeof c&&b&&c)return d=b[a],f=c[a],d===f?0:typeof d===typeof f?d<f?-1:1:typeof d<typeof f?-1:1;throw"error";}};function toInt(a){return a&&+a|0||0}function EmpApplyKeyframeByJs(a,b,c){for(var d=[],f=a.data.sort(EmpSortBy("index")),l=0;l<a.count-1;++l)if(b>=f[l].index&&b<=f[l+1].index){var g=(b-f[l].index)/(f[l+1].index-f[l].index),k;for(k in f[l])d[k]=f[l][k]+(f[l+1][k]-f[l][k])*g}a=a.css;b={};var h,n,r,q,m;for(m in a)"background-color"==a[m]||"color"==a[m]?b[a[m]]="rgba("+toInt(d[a[m]+".r"])+","+toInt(d[a[m]+".g"])+","+toInt(d[a[m]+".b"])+","+d[a[m]+".a"]+")":"left"==a[m]||"top"==a[m]||"width"==a[m]||"height"==a[m]||"font-size"==a[m]||"text-indent"==a[m]||"letter-spacing"==a[m]?b[a[m]]=d[a[m]]+"px":"opacity"==a[m]||"font-weight"==a[m]||"line-height"==a[m]?b[a[m]]=d[a[m]]:"transform-origin"==a[m]?b[a[m]]=toInt(d[a[m]+".x"])+","+toInt(d[a[m]+".y"]):"box-shadow"==a[m]||"text-shadow"==a[m]?b[a[m]]=toInt(d[a[m]+".x"])+"px "+toInt(d[a[m]+".y"])+"px "+toInt(d[a[m]+".z"])+"px rgb("+toInt(d[a[m]+".r"])+","+toInt(d[a[m]+".g"])+","+toInt(d[a[m]+".b"])+")":"Transform.1RotateAngleDegree"==a[m]?q=" rotate("+d.rotate+"deg) ":"Transform.2SkewDegree"==a[m]?r=" skew("+d["skew.x"]+"deg,"+d["skew.y"]+"deg) ":"Transform.3Scale"==a[m]?n=" scale("+d["scale.x"]+","+d["scale.y"]+") ":"Transform.0Trans"==a[m]&&(h=" translate("+d["translate.x"]+"px,"+d["translate.y"]+"px) ");if(q||r||n||h)b.transform=(h?h:"")+(q?q:"")+(r?r:"")+(n?n:"");jQuery("#"+c).css(b)}var precentX=0,precentY=0,minPrecentY=null,maxPrecentY=null,factorY=null,minPrecentX=null,maxPrecentX=null,factorX=null;function setRangeSwipeMoveX(a,b,c){minPrecentX=a;maxPrecentX=b;factorX=c}function setRangeSwipeMoveY(a,b,c){minPrecentY=a;maxPrecentY=b;factorY=c}function empSwipeMove(a,b){a.preventDefault();b.originalEvent.preventDefault();var c=b.description.split(":");switch(c[0]){case "swipemove":if(1==c[1]){precentY+=b.delta[0].startY;precentX+=b.delta[0].startX;null!=maxPrecentY&&null!=minPrecentY&&null!=factorY&&(minPrecentY>=maxPrecentY?precentY=0:precentY>maxPrecentY/factorY?precentY=maxPrecentY/factorY:precentY<minPrecentY/factorY&&(precentY=minPrecentY/factorY));null!=maxPrecentX&&precentX>maxPrecentX/factorX?precentX=maxPrecentX/factorX:null!=minPrecentX&&precentX<minPrecentX/factorX&&(precentX=minPrecentX/factorX);for(var d in swipemoveData)swipemoveData[d](precentX,precentY)}}}function createEmpButton(a,b,c,d,f){var l=empGetElementByID(a,"div",null),g=empGetElementByID(a+"_button","div",l);l.appendChild(g);var k=b.normal,h=b.pressed?b.pressed:b.normal,n=b.hover?b.hover:b.normal;g.style.cssText=c;b.color&&jQuery(g).css("background-color",b.color);k&&jQuery(g).css("background-image",b.normal);jQuery(l).bind("touchstart mousedown",function(){jQuery(g).css({transform:"translate("+d+"px,"+f+"px)"});h&&jQuery(g).css("background-image",b.pressed);jQuery(document.body).one("touchend mouseup",function(){jQuery(g).css({transform:"translate(0px,0px)"});k&&jQuery(g).css("background-image",b.normal)})});b.hover&&(jQuery(l).mouseenter(function(){jQuery(g).css({transform:"translate(0px,0px)"});n&&jQuery(g).css("background-image",b.hover)}),jQuery(l).mouseleave(function(){jQuery(g).css({transform:"translate(0px,0px)"});k&&jQuery(g).css("background-image",b.normal)}));return g}function createZoomLens(a,b,c,d,f,l,g,k){var h=empGetElementByID(a,"div",null),n=empGetElementByID(a+"_zoomlens","div",h);h.appendChild(n);var h="border-radius:1024px;",r=parseInt(k.size)||0;k=k.color||"0xffffff";d!=f&&(h="");var h=h+("border: "+r+"px solid "+k+";"),q=parseInt(jQuery("#"+a).css("width")),m=parseInt(jQuery("#"+a).css("height"));n.style.cssText="visibility:hidden; pointer-events: none;"+h+" background-image:url('"+c+"');background-size:"+b*q/d+"% "+b*m/f+"%;background-repeat:no-repeat;position:absolute;left:0px;top:0px;width:"+d+"px;height:"+f+"px;opacity:1;";jQuery("#"+a+"_zoomlens").attr("emplenshidden",1);jQuery("#"+a).bind("touchmove mousemove",function(c){if(1!=jQuery("#"+a+"_zoomlens").attr("emplenshidden")){c.preventDefault();var e=!!c.originalEvent.touches,n=e?c.originalEvent.touches[0].pageX/EmpGlobalZoom-EmpGlobalLeft-c.originalEvent.currentTarget.offsetLeft:c.originalEvent.offsetX/EmpGlobalZoom,h=e?c.originalEvent.touches[0].pageY/EmpGlobalZoom-EmpGlobalTop-c.originalEvent.currentTarget.offsetTop:c.originalEvent.offsetY/EmpGlobalZoom,e=100*n/c.originalEvent.currentTarget.clientWidth;c=100*h/c.originalEvent.currentTarget.clientHeight;0>e||100<e||0>c||100<c||(jQuery("#"+a+"_zoomlens").css("visibility","visible"),n-=.5*d,h-=.5*f,e=-1*(b*q/100*e/100-d/2),c=-1*(b*m/100*c/100-f/2),jQuery("#"+a+"_zoomlens").css({left:l+n+"px",top:g+h+"px"}),jQuery("#"+a+"_zoomlens").css("background-position",e+"px "+c+"px"))}});jQuery("#"+a).bind("touchstart mousedown",function(){jQuery("#"+a+"_zoomlens").attr("emplenshidden",0);jQuery("#"+a).one("touchend mouseup",function(){jQuery("#"+a+"_zoomlens").css("visibility","hidden");jQuery("#"+a+"_zoomlens").attr("emplenshidden",1)});jQuery(document.body).one("touchend mouseup",function(){jQuery("#"+a+"_zoomlens").css("visibility","hidden");jQuery("#"+a+"_zoomlens").attr("emplenshidden",1)})})}function createSwitchImage(a){var b=!1,c=empGetElementByID(a.divid,"div",null),d=empGetElementByID(a.divid+"_mask","div",c);d.style.backgroundImage="url('"+a.maskImg+"')";d.style.backgroundSize="100% 100%";d.style.backgroundRepeat="no-repeat";d.style.pointerEvents="none";d.style.width=a.verticalFlag?"0px":c.style.width;d.style.height=a.verticalFlag?c.style.height:"0px";d.style.left="0px";d.style.top="0px";d.style.position="absolute";d=empGetElementByID(a.divid+"_seperator","div",c);d.style.backgroundImage="url('"+a.seperatorImg+"')";d.style.backgroundSize="100% 100%";d.style.backgroundRepeat="no-repeat";d.style.pointerEvents="none";d.style.width=a.verticalFlag?a.sepWidth+"px":parseInt(c.style.width)+2*a.sepWidth+"px";d.style.height=a.verticalFlag?parseInt(c.style.height)+2*a.sepHeight+"px":a.sepHeight+"px";d.style.left=a.verticalFlag?-.5*a.sepWidth+"px":-1*a.sepWidth+"px";d.style.top=a.verticalFlag?-1*a.sepHeight+"px":-.5*a.sepHeight+"px";d.style.position="absolute";jQuery("#"+a.divid).bind("touchmove mousemove",function(c){if(0!=b){c.preventDefault();var d=!!c.originalEvent.touches,g=d?c.originalEvent.touches[0].pageX/EmpGlobalZoom-EmpGlobalLeft-c.originalEvent.currentTarget.offsetLeft:c.originalEvent.offsetX/EmpGlobalZoom,d=d?c.originalEvent.touches[0].pageY/EmpGlobalZoom-EmpGlobalTop-c.originalEvent.currentTarget.offsetTop:c.originalEvent.offsetY/EmpGlobalZoom,k=100*g/c.originalEvent.currentTarget.clientWidth,h=100*d/c.originalEvent.currentTarget.clientHeight;0>k&&(g=k=0);100<k&&(k=100,g=c.originalEvent.currentTarget.clientWidth);0>h&&(d=h=0);100<h&&(h=100,d=c.originalEvent.currentTarget.clientHeight);a.verticalFlag?jQuery("#"+a.divid+"_mask").css({width:g+"px","background-size":1E4/k+"% 100%"}):jQuery("#"+a.divid+"_mask").css({height:d+"px","background-size":"100%"+1E4/h+"%"});a.verticalFlag?jQuery("#"+a.divid+"_seperator").css({left:g-.5*a.sepWidth+"px"}):jQuery("#"+a.divid+"_seperator").css({top:d-.5*a.sepHeight+"px"});c.preventDefault()}});jQuery("#"+a.divid).bind("touchstart mousedown",function(){b=!0;jQuery("#"+a.divid).one("touchend mouseup",function(){b=!1});jQuery(document.body).one("touchend mouseup",function(){b=!1})})}function empGetElementByID(a,b,c,d){var f=document.getElementById(a);null==f&&(f=document.createElement(b),f.id=a,c?c.appendChild(f):document.body.appendChild(f),"function"===typeof d&&d(f));return f}function empDeleteElementByID(a){(a=document.getElementById(a))&&a.parentNode.removeChild(a)}function empShowElementByID(a,b){var c=document.getElementById(a);c&&(c.style.visibility=b)}function empSetPEElementByID(a,b){var c=document.getElementById(a);c&&(c.style.pointerEvents=b)}function empSetOpacityElementByID(a,b){var c=document.getElementById(a);c&&(c.style.opacity=b)}function empSetFullScreen(a){a.requestFullscreen?a.requestFullscreen():a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen?a.webkitRequestFullScreen():a.msRequestFullscreen&&a.msRequestFullscreen()}function empExitFullScreen(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}function empIsFullScreen(){return document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled}window.addEventListener("load",function(){EmpAutoBodySize()},!1);isBuilderMode||window.addEventListener("resize",EmpAutoBodySize,!1);var LZMA=LZMA||{};LZMA.OutWindow=function(){this._windowSize=0};LZMA.OutWindow.prototype.create=function(a){this._buffer&&this._windowSize===a||(this._buffer=[]);this._windowSize=a;this._streamPos=this._pos=0};LZMA.OutWindow.prototype.flush=function(){var a=this._pos-this._streamPos;if(0!==a){for(;a--;)this._stream.writeByte(this._buffer[this._streamPos++]);this._pos>=this._windowSize&&(this._pos=0);this._streamPos=this._pos}};LZMA.OutWindow.prototype.releaseStream=function(){this.flush();this._stream=null};LZMA.OutWindow.prototype.setStream=function(a){this.releaseStream();this._stream=a};LZMA.OutWindow.prototype.init=function(a){a||(this._pos=this._streamPos=0)};LZMA.OutWindow.prototype.copyBlock=function(a,b){var c=this._pos-a-1;for(0>c&&(c+=this._windowSize);b--;)c>=this._windowSize&&(c=0),this._buffer[this._pos++]=this._buffer[c++],this._pos>=this._windowSize&&this.flush()};LZMA.OutWindow.prototype.putByte=function(a){this._buffer[this._pos++]=a;this._pos>=this._windowSize&&this.flush()};LZMA.OutWindow.prototype.getByte=function(a){a=this._pos-a-1;0>a&&(a+=this._windowSize);return this._buffer[a]};LZMA.RangeDecoder=function(){};LZMA.RangeDecoder.prototype.setStream=function(a){this._stream=a};LZMA.RangeDecoder.prototype.releaseStream=function(){this._stream=null};LZMA.RangeDecoder.prototype.init=function(){var a=5;this._code=0;for(this._range=-1;a--;)this._code=this._code<<8|this._stream.readByte()};LZMA.RangeDecoder.prototype.decodeDirectBits=function(a){for(var b=0,c;a--;)this._range>>>=1,c=this._code-this._range>>>31,this._code-=this._range&c-1,b=b<<1|1-c,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return b};LZMA.RangeDecoder.prototype.decodeBit=function(a,b){var c=a[b],d=(this._range>>>11)*c;if((this._code^2147483648)<(d^2147483648))return this._range=d,a[b]+=2048-c>>>5,0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),0;this._range-=d;this._code-=d;a[b]-=c>>>5;0===(this._range&4278190080)&&(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return 1};LZMA.initBitModels=function(a,b){for(;b--;)a[b]=1024};LZMA.BitTreeDecoder=function(a){this._models=[];this._numBitLevels=a};LZMA.BitTreeDecoder.prototype.init=function(){LZMA.initBitModels(this._models,1<<this._numBitLevels)};LZMA.BitTreeDecoder.prototype.decode=function(a){for(var b=1,c=this._numBitLevels;c--;)b=b<<1|a.decodeBit(this._models,b);return b-(1<<this._numBitLevels)};LZMA.BitTreeDecoder.prototype.reverseDecode=function(a){for(var b=1,c=0,d=0,f;d<this._numBitLevels;++d)f=a.decodeBit(this._models,b),b=b<<1|f,c|=f<<d;return c};LZMA.reverseDecode2=function(a,b,c,d){for(var f=1,l=0,g=0,k;g<d;++g)k=c.decodeBit(a,b+f),f=f<<1|k,l|=k<<g;return l};LZMA.LenDecoder=function(){this._choice=[];this._lowCoder=[];this._midCoder=[];this._highCoder=new LZMA.BitTreeDecoder(8);this._numPosStates=0};LZMA.LenDecoder.prototype.create=function(a){for(;this._numPosStates<a;++this._numPosStates)this._lowCoder[this._numPosStates]=new LZMA.BitTreeDecoder(3),this._midCoder[this._numPosStates]=new LZMA.BitTreeDecoder(3)};LZMA.LenDecoder.prototype.init=function(){var a=this._numPosStates;for(LZMA.initBitModels(this._choice,2);a--;)this._lowCoder[a].init(),this._midCoder[a].init();this._highCoder.init()};LZMA.LenDecoder.prototype.decode=function(a,b){return 0===a.decodeBit(this._choice,0)?this._lowCoder[b].decode(a):0===a.decodeBit(this._choice,1)?8+this._midCoder[b].decode(a):16+this._highCoder.decode(a)};LZMA.Decoder2=function(){this._decoders=[]};LZMA.Decoder2.prototype.init=function(){LZMA.initBitModels(this._decoders,768)};LZMA.Decoder2.prototype.decodeNormal=function(a){var b=1;do b=b<<1|a.decodeBit(this._decoders,b);while(256>b);return b&255};LZMA.Decoder2.prototype.decodeWithMatchByte=function(a,b){var c=1,d,f;do if(d=b>>7&1,b<<=1,f=a.decodeBit(this._decoders,(1+d<<8)+c),c=c<<1|f,d!==f){for(;256>c;)c=c<<1|a.decodeBit(this._decoders,c);break}while(256>c);return c&255};LZMA.LiteralDecoder=function(){};LZMA.LiteralDecoder.prototype.create=function(a,b){var c;if(!this._coders||this._numPrevBits!==b||this._numPosBits!==a)for(this._numPosBits=a,this._posMask=(1<<a)-1,this._numPrevBits=b,this._coders=[],c=1<<this._numPrevBits+this._numPosBits;c--;)this._coders[c]=new LZMA.Decoder2};LZMA.LiteralDecoder.prototype.init=function(){for(var a=1<<this._numPrevBits+this._numPosBits;a--;)this._coders[a].init()};LZMA.LiteralDecoder.prototype.getDecoder=function(a,b){return this._coders[((a&this._posMask)<<this._numPrevBits)+((b&255)>>>8-this._numPrevBits)]};LZMA.Decoder=function(){this._outWindow=new LZMA.OutWindow;this._rangeDecoder=new LZMA.RangeDecoder;this._isMatchDecoders=[];this._isRepDecoders=[];this._isRepG0Decoders=[];this._isRepG1Decoders=[];this._isRepG2Decoders=[];this._isRep0LongDecoders=[];this._posSlotDecoder=[];this._posDecoders=[];this._posAlignDecoder=new LZMA.BitTreeDecoder(4);this._lenDecoder=new LZMA.LenDecoder;this._repLenDecoder=new LZMA.LenDecoder;this._literalDecoder=new LZMA.LiteralDecoder;this._dictionarySizeCheck=this._dictionarySize=-1;this._posSlotDecoder[0]=new LZMA.BitTreeDecoder(6);this._posSlotDecoder[1]=new LZMA.BitTreeDecoder(6);this._posSlotDecoder[2]=new LZMA.BitTreeDecoder(6);this._posSlotDecoder[3]=new LZMA.BitTreeDecoder(6)};LZMA.Decoder.prototype.setDictionarySize=function(a){if(0>a)return!1;this._dictionarySize!==a&&(this._dictionarySize=a,this._dictionarySizeCheck=Math.max(this._dictionarySize,1),this._outWindow.create(Math.max(this._dictionarySizeCheck,4096)));return!0};LZMA.Decoder.prototype.setLcLpPb=function(a,b,c){var d=1<<c;if(8<a||4<b||4<c)return!1;this._literalDecoder.create(b,a);this._lenDecoder.create(d);this._repLenDecoder.create(d);this._posStateMask=d-1;return!0};LZMA.Decoder.prototype.init=function(){var a=4;this._outWindow.init(!1);LZMA.initBitModels(this._isMatchDecoders,192);LZMA.initBitModels(this._isRep0LongDecoders,192);LZMA.initBitModels(this._isRepDecoders,12);LZMA.initBitModels(this._isRepG0Decoders,12);LZMA.initBitModels(this._isRepG1Decoders,12);LZMA.initBitModels(this._isRepG2Decoders,12);LZMA.initBitModels(this._posDecoders,114);for(this._literalDecoder.init();a--;)this._posSlotDecoder[a].init();this._lenDecoder.init();this._repLenDecoder.init();this._posAlignDecoder.init();this._rangeDecoder.init()};LZMA.Decoder.prototype.decode=function(a,b,c){var d=0,f=0,l=0,g=0,k=0,h=0,n=0;this._rangeDecoder.setStream(a);this._outWindow.setStream(b);for(this.init();0>c||h<c;)if(a=h&this._posStateMask,0===this._rangeDecoder.decodeBit(this._isMatchDecoders,(d<<4)+a))n=this._literalDecoder.getDecoder(h++,n),n=7<=d?n.decodeWithMatchByte(this._rangeDecoder,this._outWindow.getByte(f)):n.decodeNormal(this._rangeDecoder),this._outWindow.putByte(n),d=4>d?0:d-(10>d?3:6);else{if(1===this._rangeDecoder.decodeBit(this._isRepDecoders,d))n=0,0===this._rangeDecoder.decodeBit(this._isRepG0Decoders,d)?0===this._rangeDecoder.decodeBit(this._isRep0LongDecoders,(d<<4)+a)&&(d=7>d?9:11,n=1):(0===this._rangeDecoder.decodeBit(this._isRepG1Decoders,d)?b=l:(0===this._rangeDecoder.decodeBit(this._isRepG2Decoders,d)?b=g:(b=k,k=g),g=l),l=f,f=b),0===n&&(n=2+this._repLenDecoder.decode(this._rangeDecoder,a),d=7>d?8:11);else if(k=g,g=l,l=f,n=2+this._lenDecoder.decode(this._rangeDecoder,a),d=7>d?7:10,a=this._posSlotDecoder[5>=n?n-2:3].decode(this._rangeDecoder),4<=a)if(b=(a>>1)-1,f=(2|a&1)<<b,14>a)f+=LZMA.reverseDecode2(this._posDecoders,f-a-1,this._rangeDecoder,b);else{if(f+=this._rangeDecoder.decodeDirectBits(b-4)<<4,f+=this._posAlignDecoder.reverseDecode(this._rangeDecoder),0>f){if(-1===f)break;return!1}}else f=a;if(f>=h||f>=this._dictionarySizeCheck)return!1;this._outWindow.copyBlock(f,n);h+=n;n=this._outWindow.getByte(0)}this._outWindow.flush();this._outWindow.releaseStream();this._rangeDecoder.releaseStream();return!0};LZMA.Decoder.prototype.setDecoderProperties=function(a){var b,c;if(5>a.size)return!1;b=a.readByte();c=b%9;b=~~(b/9);if(!this.setLcLpPb(c,b%5,~~(b/5)))return!1;b=a.readByte();b|=a.readByte()<<8;b|=a.readByte()<<16;b+=16777216*a.readByte();return this.setDictionarySize(b)};LZMA.decompress=function(a,b,c,d){var f=new LZMA.Decoder;if(!f.setDecoderProperties(a))throw"Incorrect stream properties";if(!f.decode(b,c,d))throw"Error in data stream";return!0};LZMA.decompressFile=function(a,b){var c=new LZMA.Decoder,d;if(!c.setDecoderProperties(a))throw"Incorrect stream properties";d=a.readByte();d|=a.readByte()<<8;d|=a.readByte()<<16;d+=16777216*a.readByte();a.readByte();a.readByte();a.readByte();a.readByte();if(!c.decode(a,b,d))throw"Error in data stream";return!0};EMPLZMAUncompress=function(a){a=new Uint8Array(a);var b={data:[],position:0,writeByte:function(a){this.data[this.position++]=a}};LZMA.decompressFile({data:a,position:0,readByte:function(){return this.data[this.position++]}},b);return(new Uint8Array(b.data)).buffer};THREE.JsonEmpLoader=function(a){"boolean"===typeof a&&(console.warn("THREE.JsonEmpLoader: showStatus parameter has been removed from constructor."),a=void 0);this.manager=void 0!==a?a:THREE.DefaultLoadingManager;this.withCredentials=!1};THREE.JsonEmpLoader.prototype={constructor:THREE.JsonEmpLoader,get statusDomElement(){void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div"));console.warn("THREE.JsonEmpLoader: .statusDomElement has been removed.");return this._statusDomElement},load:function(a,b,c,d,f,l){var g=this,k=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:THREE.Loader.prototype.extractUrlBase(a),h=new THREE.XHRLoader(this.manager);h.setWithCredentials(this.withCredentials);h.load(a,function(a){var d=JSON.parse(a);a=k+"index.lz.js";var f=new THREE.XHRLoader(this.manager);f.setWithCredentials(this.withCredentials);f.setPath(this.path);f.setResponseType("arraybuffer");f.load(a,function(a){if("undefined"!==typeof d.guid)for(key in d.guid){var f=d.guid[key],e=new Uint8Array(a,f.l0,f.l1);g.convertBufferToJson(f,e,k);var e=f.metadata,f=g.parse(f,k),n=new THREE.Matrix4;e.notOrth||n.set(e.mat_wts[0],e.mat_wts[1],e.mat_wts[2],e.mat_wts[3],e.mat_wts[4],e.mat_wts[5],e.mat_wts[6],e.mat_wts[7],e.mat_wts[8],e.mat_wts[9],e.mat_wts[10],e.mat_wts[11],e.mat_wts[12],e.mat_wts[13],e.mat_wts[14],e.mat_wts[15]);f=b(f.geometry,f.materials,n);f.name=e.meshName;f.visible=e.visible}if("undefined"!==typeof d.guidCam)for(key in d.guidCam){f=d.guidCam[key];if(void 0===f.metadata||0!=f.metadata.isAniCamera)e=new Uint8Array(a,f.l0,f.l1),g.convertBufferToJson(f,e);e=f.metadata;f=g.parseCamera(f,k);f=c(f);f.name=e.name}"function"==typeof l&&l()})},d,f)},setTexturePath:function(a){this.texturePath=a},convertBufferToJson:function(a,b){var c=EMPLZMAUncompress(b);a.vertices=this._loadBinFileWithBuffer(a.vertices,c,"float");a.normals=this._loadBinFileWithBuffer(a.normals,c,"float");void 0!==a.uvs&&void 0!==a.uvs[0]&&(a.uvs[0]=this._loadBinFileWithBuffer(a.uvs[0],c,"float"));void 0!==a.uvs&&void 0!==a.uvs[1]&&(a.uvs[1]=this._loadBinFileWithBuffer(a.uvs[1],c,"float"));a.faces=this._loadBinFileWithBuffer(a.faces,c,"int32");if("undefined"!==typeof a.animations&&"undefined"!=typeof a.animations.tracks)for(keyIdx in a.animations.tracks){var d=a.animations.tracks[keyIdx];"vector3"===d.type?d.keys=this._loadBinFileWithBuffer(d.keys,c,"timeVector3"):"quaternion"===d.type?d.keys=this._loadBinFileWithBuffer(d.keys,c,"timeQuaternion"):"float"===d.type&&(d.keys=this._loadBinFileWithBuffer(d.keys,c,"timefloat"))}},_loadBinFileWithBuffer:function(a,b,c){if(void 0!==a&&void 0!==b&&void 0!==a.offset&&void 0!==a.length&&0<a.length){var d=[];if("float"==c)return a=new Float32Array(b,a.offset,a.length/4);if("int32"===c)return a=new Int32Array(b,a.offset,a.length/4);if("timeVector3"===c){b=new Float32Array(b,a.offset,a.length/4);for(c=0;c<a.length/4;){var f={time:b[c],value:[b[c+1],b[c+2],b[c+3]]};c+=4;d.push(f)}return d}if("timeQuaternion"===c){b=new Float32Array(b,a.offset,a.length/4);for(c=0;c<a.length/4;)f={time:b[c],value:[b[c+1],b[c+2],b[c+3],b[c+4]]},c+=5,d.push(f);return d}if("timefloat"===c){b=new Float32Array(b,a.offset,a.length/4);for(c=0;c<a.length/4;)f={time:b[c],value:b[c+1]},c+=2,d.push(f);return d}}},parseCamera:function(a){var b=[],c=[];void 0!==a.animation&&c.push(a.animation);void 0!==a.animations&&(a.animations.length?c=c.concat(a.animations):c.push(a.animations));if(c)for(a=0;a<c.length;a++){var d=THREE.AnimationClip.parse(c[a]);d&&b.push(d)}return b},parse:function(a,b){var c=new THREE.Geometry,d=void 0!==a.scale?1/a.scale:1;(function(b){var d,g,k,h,n,r,q,m,u,e,x,z,y,p=a.faces;r=a.vertices;var t=a.normals,A=a.colors,v=0;if(void 0!==a.uvs){for(d=0;d<a.uvs.length;d++)a.uvs[d].length&&v++;for(d=0;d<v;d++)c.faceVertexUvs[d]=[]}h=0;for(n=r.length;h<n;)d=new THREE.Vector3,d.x=r[h++]*b,d.y=r[h++]*b,d.z=r[h++]*b,c.vertices.push(d);h=0;for(n=p.length;h<n;)if(b=p[h++],u=b&1,k=b&2,d=b&8,q=b&16,e=b&32,r=b&64,b&=128,u){u=new THREE.Face3;u.a=p[h];u.b=p[h+1];u.c=p[h+3];x=new THREE.Face3;x.a=p[h+1];x.b=p[h+2];x.c=p[h+3];h+=4;k&&(k=p[h++],u.materialIndex=k,x.materialIndex=k);k=c.faces.length;if(d)for(d=0;d<v;d++)for(z=a.uvs[d],c.faceVertexUvs[d][k]=[],c.faceVertexUvs[d][k+1]=[],g=0;4>g;g++)m=p[h++],y=z[2*m],m=z[2*m+1],y=new THREE.Vector2(y,m),2!==g&&c.faceVertexUvs[d][k].push(y),0!==g&&c.faceVertexUvs[d][k+1].push(y);q&&(q=3*p[h++],u.normal.set(t[q++],t[q++],t[q]),x.normal.copy(u.normal));if(e)for(d=0;4>d;d++)q=3*p[h++],e=new THREE.Vector3(t[q++],t[q++],t[q]),2!==d&&u.vertexNormals.push(e),0!==d&&x.vertexNormals.push(e);r&&(r=p[h++],r=A[r],u.color.setHex(r),x.color.setHex(r));if(b)for(d=0;4>d;d++)r=p[h++],r=A[r],2!==d&&u.vertexColors.push(new THREE.Color(r)),0!==d&&x.vertexColors.push(new THREE.Color(r));c.faces.push(u);c.faces.push(x)}else{u=new THREE.Face3;u.a=p[h++];u.b=p[h++];u.c=p[h++];k&&(k=p[h++],u.materialIndex=k);k=c.faces.length;if(d)for(d=0;d<v;d++)for(z=a.uvs[d],c.faceVertexUvs[d][k]=[],g=0;3>g;g++)m=p[h++],y=z[2*m],m=z[2*m+1],y=new THREE.Vector2(y,m),c.faceVertexUvs[d][k].push(y);q&&(q=3*p[h++],u.normal.set(t[q++],t[q++],t[q]));if(e)for(d=0;3>d;d++)q=3*p[h++],e=new THREE.Vector3(t[q++],t[q++],t[q]),u.vertexNormals.push(e);r&&(r=p[h++],u.color.setHex(A[r]));if(b)for(d=0;3>d;d++)r=p[h++],u.vertexColors.push(new THREE.Color(A[r]));c.faces.push(u)}})(d);(function(){var b=void 0!==a.influencesPerVertex?a.influencesPerVertex:2;if(a.skinWeights)for(var d=0,g=a.skinWeights.length;d<g;d+=b)c.skinWeights.push(new THREE.Vector4(a.skinWeights[d],1<b?a.skinWeights[d+1]:0,2<b?a.skinWeights[d+2]:0,3<b?a.skinWeights[d+3]:0));if(a.skinIndices)for(d=0,g=a.skinIndices.length;d<g;d+=b)c.skinIndices.push(new THREE.Vector4(a.skinIndices[d],1<b?a.skinIndices[d+1]:0,2<b?a.skinIndices[d+2]:0,3<b?a.skinIndices[d+3]:0));c.bones=a.bones;c.bones&&0<c.bones.length&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&console.warn("When skinning, number of vertices ("+c.vertices.length+"), skinIndices ("+c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.")})();(function(b){if(void 0!==a.morphTargets)for(var d=0,g=a.morphTargets.length;d<g;d++){c.morphTargets[d]={};c.morphTargets[d].name=a.morphTargets[d].name;c.morphTargets[d].vertices=[];for(var k=c.morphTargets[d].vertices,h=a.morphTargets[d].vertices,n=0,r=h.length;n<r;n+=3){var q=new THREE.Vector3;q.x=h[n]*b;q.y=h[n+1]*b;q.z=h[n+2]*b;k.push(q)}}if(void 0!==a.morphColors&&0<a.morphColors.length)for(console.warn('THREE.JsonEmpLoader: "morphColors" no longer supported. Using them as face colors.'),b=c.faces,k=a.morphColors[0].colors,d=0,g=b.length;d<g;d++)b[d].color.fromArray(k,3*d)})(d);(function(){var b=[],d=[];void 0!==a.animation&&d.push(a.animation);void 0!==a.animations&&(a.animations.length?d=d.concat(a.animations):d.push(a.animations));if(c.bones&&0<c.bones.length)for(var g=0;g<d.length;g++){var k=THREE.AnimationClip.parseAnimation(d[g],c.bones);k&&b.push(k)}c.morphTargets&&(g=THREE.AnimationClip.CreateClipsFromMorphTargetSequences(c.morphTargets,10),b=b.concat(g));if(d)for(g=0;g<d.length;g++)(k=THREE.AnimationClip.parse(d[g]))&&b.push(k);0<b.length&&(c.animations=b)})();c.computeFaceNormals();c.computeBoundingSphere();if(void 0===a.materials||0===a.materials.length)return{geometry:c};d=THREE.Loader.prototype.initMaterials(a.materials,b,this.crossOrigin);return{geometry:c,materials:d}}};var scene3D=[],scene3DFunction=[];EmpScene=function(){this.name="empscene";this.scene=this.controls=this.camera=this.container=this.renderer=null;this.valid=!1;this.stats=this.grid=null;this.sceneBoundingBox=new THREE.Box3;this.sceneBoundingBox.makeEmpty();this.clearColor=3829413;this.clearAlpha=1;this.selected=null;this.raycaster=new THREE.Raycaster;this.actived=!1;this.sceneHelpers=null;this.showSkyboxFlag=this.showGridFlag=this.showAxisFlag=!1;this.clock=this.mixer=this.skyboxCamera=this.skyboxMesh=this.skyboxTexture=this.skyboxScene=null;this.models=[];this.group={};this.bindingDomUI=[];this.cameras=[]};EmpScene.prototype={constructor:EmpScene,setScene:function(a){this.scene.uuid=a.uuid;this.scene.name=a.name;for(this.scene.userData=JSON.parse(JSON.stringify(a.userData));0<a.children.length;)this.addObject(a.children[0])},select:function(a){this.selected!==a&&(this.selected=a)},selectById:function(a){a===this.camera.id?this.select(this.camera):this.select(this.scene.getObjectById(a,!0))},selectByUuid:function(a){var b=this;this.scene.traverse(function(c){c.uuid===a&&b.select(c)})},deselect:function(){this.select(null)},findObjectByName:function(a){if(!this.scene)return null;for(var b in this.scene.children){var c=this.scene.children[b];if(c.name==a)return c}return null},removeObjectByName:function(a){(a=this.findObjectByName(a))&&a.parent.remove(a)},addObject:function(a){this.findObjectByName(a.name)||this.scene.add(a)},addHelper:function(){var a=new THREE.BoxHelper;a.material.depthTest=!1;a.material.transparent=!0;a.name="EMPBOX";a.visible=!1;this.sceneHelpers.add(a);a=new THREE.GridHelper(1E3,10);a.name="EMPGROUND";a.visible=!1;this.sceneHelpers.add(a);a=new THREE.AxisHelper(500);a.name="EMPAXIS";a.visible=!1;this.sceneHelpers.add(a);this.skyboxCamera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1E5);this.skyboxTexture=(new THREE.CubeTextureLoader).load("../js/emp/c_RT.jpg ../js/emp/c_LF.jpg ../js/emp/c_UP.jpg ../js/emp/c_DN.jpg ../js/emp/c_BK.jpg ../js/emp/c_FR.jpg".split(" "));this.skyboxTexture.format=THREE.RGBFormat;this.skyboxTexture.mapping=THREE.CubeReflectionMapping;a=THREE.ShaderLib.cube;a=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:a.uniforms,depthWrite:!1,side:THREE.BackSide});a.uniforms.tCube.value=this.skyboxTexture;this.skyboxMesh=new THREE.Mesh(new THREE.BoxGeometry(1E3,1E3,1E3),a);this.skyboxScene.add(this.skyboxMesh)},showAxis:function(a){this.showAxisFlag=a;for(var b in this.sceneHelpers.children)a=this.sceneHelpers.children[b],"EMPAXIS"==a.name&&(a.visible=this.showAxisFlag)},showGround:function(a){this.showGridFlag=a;for(var b in this.sceneHelpers.children)a=this.sceneHelpers.children[b],"EMPGROUND"==a.name&&(a.visible=this.showGridFlag)},showSkybox:function(a){this.showSkyboxFlag=a;this.skyboxMesh.visible=this.showSkyboxFlag},findObjectByUUID:function(a){if(!this.scene)return null;for(var b in this.scene.children){var c=this.scene.children[b];if(c.uuid==a)return c}return null},setClearColor:function(a,b){this.clearColor=a;this.clearAlpha=b;this.renderer.setClearColor(this.clearColor,this.clearAlpha)},getObjs:function(){if(this.scene)for(var a in this.scene.children){var b=this.scene.children[a];"Mesh"==b.type?(this.modelsmodels[b.uuid]=b,this.models[b.material.uuid]=b.material):this.models[b.uuid]=b}},clearScene:function(){this.camera.position.set(500,250,500);this.camera.lookAt(new THREE.Vector3);for(var a=this.scene.children;0<a.length;)this.removeObject(a[0]);this.geometries={};this.materials={};this.textures={};this.scripts={};this.deselect()},removeHelper:function(a){},removeObject:function(a){if(void 0!==a.parent){var b=this;a.traverse(function(a){b.removeHelper(a)});a.parent.remove(a)}},initScene:function(a,b){function c(a){a.preventDefault();var b=new THREE.Vector2,c=!!a.touches,d=c?a.touches[0].pageX/EmpGlobalZoom-EmpGlobalLeft-a.currentTarget.offsetLeft:a.offsetX/EmpGlobalZoom,c=c?a.touches[0].pageY/EmpGlobalZoom-EmpGlobalTop-a.currentTarget.offsetTop:a.offsetY/EmpGlobalZoom,d=d/a.currentTarget.clientWidth,c=c/a.currentTarget.clientHeight;b.x=2*d-1;b.y=1-2*c;f.raycaster.setFromCamera(b,f.camera);b=f.raycaster.intersectObjects(f.scene.children);if(0<b.length&&(b=b[0].object)&&"Mesh"==b.type)if("mouseup"==a.type||"touchend"==a.type){if("function"==typeof scene3DFunction[b.name+"_up"])scene3DFunction[b.name+"_up"]()}else if(("mousedown"==a.type||"touchstart"==a.type)&&"function"==typeof scene3DFunction[b.name+"_down"])scene3DFunction[b.name+"_down"]()}var d=b;void 0==d&&(d="orbit");this.valid=!1;this.container=document.getElementById(a);if(!this.container)return null;this.clock=new THREE.Clock;this.scene=new THREE.Scene;this.sceneHelpers=new THREE.Scene;this.skyboxScene=new THREE.Scene;this.addHelper();this.camera=new THREE.PerspectiveCamera(50,this.container.offsetWidth/this.container.offsetHeight,.1,1E4);"orbit"==d?(this.controls=new THREE.OrbitControls(this.camera,this.container),this.controls.enableDamping=!0,this.controls.dampingFactor=.1,this.controls.enableZoom=!0,this.controls.rotateSpeed=.1):"fly"==d?(this.controls=new THREE.FlyControls(this.camera,this.container),this.controls.movementSpeed=1E3,this.controls.rollSpeed=Math.PI/24,this.controls.autoForward=!1,this.controls.dragToLook=!1):"trackball"==d&&(this.controls=new THREE.TrackballControls(this.camera,this.container));isBuilderMode&&(this.controls.enabled=!1);this.createRender(!0);var f=this;this.container.addEventListener("mousedown",c,!1);this.container.addEventListener("mouseup",c,!1);this.container.addEventListener("touchstart",c,!1);this.container.addEventListener("touchend",c,!1)},createRender:function(a){a=new THREE.WebGLRenderer({antialias:a,alpha:!0});a.setClearColor(this.clearColor,this.clearAlpha);a.setPixelRatio(window.devicePixelRatio);a.autoClear=!1;a.autoUpdateScene=!1;a.setSize(this.container.offsetWidth,this.container.offsetHeight);this.container.appendChild(a.domElement);this.renderer=a},createStat:function(){var a=new Stats;a.domElement.style.position="absolute";a.domElement.style.top="0px";this.container.appendChild(a.domElement);this.stats=a},getMaterialByObjName:function(a){return(a=this.findObjectByName(a))&&"Mesh"==a.type?a.material:null},setMaterialByObjName:function(a,b){var c=this.findObjectByName(a);c?"Mesh"==c.type?c.material=b:console.log("obj not mesh",a):console.log("obj not found",a)},showModelByName:function(a,b){for(var c in this.scene.children){var d=this.scene.children[c];"Mesh"!=d.type||a!=d.name&&"EMPALLMODEL"!=a||(d.visible=b)}},showGroupByName:function(a,b){for(var c in this.group[a]){var d=this.group[a][c];"Mesh"==d.type&&(d.visible=b)}},getGroupBoundingBox:function(a){var b=new THREE.Box3;b.makeEmpty();for(var c in this.group[a]){var d=this.group[a][c];"Mesh"==d.type&&(d=d.geometry.boundingBox,b.expandByPoint(d.min),b.expandByPoint(d.max))}return b},loadEmpObjs:function(a,b,c,d,f){var l=this,g=new THREE.JsonEmpLoader,k=[];this.group[b]=k;g.load(a,function(a,b,f){b=b[0];"undefined"!==typeof d&&d.computNormal&&(a.computeFaceNormals(),a.computeVertexNormals());mesh1=new THREE.Mesh(a,b);c||(c="");mesh1.name=c+a.name;mesh1.visible=a.visible;mesh1.applyMatrix(f);mesh1.updateMatrixWorld(!0);a.computeBoundingBox();f=new THREE.Box3;f.copy(a.boundingBox);f.applyMatrix4(mesh1.matrixWorld);l.sceneBoundingBox.expandByPoint(f.min);l.sceneBoundingBox.expandByPoint(f.max);bbspere=l.sceneBoundingBox.getBoundingSphere();l.sceneBoundingBox.center();l.scene.add(mesh1);k.push(mesh1);"undefined"!==typeof d&&d.autoPlay&&(l.mixer||(l.mixer=new THREE.AnimationMixer(l.scene)),a.animations&&l.mixer.clipAction(a.animations[0],mesh1).setDuration(30*a.animations[0].duration).startAt(0).play());return mesh1},function(a){var b=new THREE.PerspectiveCamera(50,l.container.offsetWidth/l.container.offsetHeight,.1,1E4);void 0!==a&&1<=a.length&&(b.animations=a);l.cameras.push(b);return b},void 0,void 0,f)},resetAniModel:function(){this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));for(var a in this.scene.children){var b=this.scene.children[a];"Mesh"==b.type&&b.geometry.animations&&this.mixer.clipAction(b.geometry.animations[0],b).stop()}},resetAniCamera:function(a){this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));for(key in this.cameras){var b=this.cameras[key];b.name==a&&b.animations&&this.mixer.clipAction(b.animations[0],this.controls).stop()}},pauseAniCamera:function(a){this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));for(key in this.cameras){var b=this.cameras[key];b.name==a&&b.animations&&(this.mixer.clipAction(b.animations[0],this.controls).paused=!0)}},replayAniCamera:function(a){this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));for(key in this.cameras){var b=this.cameras[key];b.name==a&&b.animations&&(this.mixer.clipAction(b.animations[0],this.controls).paused=!1)}},pauseAniModel:function(){this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));for(var a in this.scene.children){var b=this.scene.children[a];"Mesh"==b.type&&b.geometry.animations&&(this.mixer.clipAction(b.geometry.animations[0],b).paused=!0)}},replayAniModel:function(){this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));for(var a in this.scene.children){var b=this.scene.children[a];"Mesh"==b.type&&b.geometry.animations&&(this.mixer.clipAction(b.geometry.animations[0],b).paused=!1)}},playAniModel:function(a,b){var c=1;"undefined"!==typeof b&&(c=b);this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));var d=parseFloat(a);isNaN(d)&&(d=1);for(var f in this.scene.children){var l=this.scene.children[f];"Mesh"==l.type&&l.geometry.animations&&this.mixer.clipAction(l.geometry.animations[0],l).setDuration(30*l.geometry.animations[0].duration*d).startAt(null).setLoop(THREE.LoopRepeat,c).play()}},palyAniCamera:function(a,b,c){var d=1;"undefined"!==typeof c&&(d=c);b=parseFloat(b);isNaN(b)&&(b=1);this.mixer||(this.mixer=new THREE.AnimationMixer(this.scene));for(key in this.cameras)c=this.cameras[key],c.name==a&&c.animations&&this.mixer.clipAction(c.animations[0],this.controls).setDuration(30*c.animations[0].duration*b).startAt(null).setLoop(THREE.LoopRepeat,d).play()},switchCamera:function(a,b,c,d){this.controls.target=c;this.controls.object.position.copy(d);this.controls.object.up.copy(new THREE.Vector3(0,1,0))},switchToCameraAni:function(a,b,c){this.controls.object.up.copy(new THREE.Vector3(0,1,0));b&&(new TWEEN.Tween(this.controls.object.position)).to(b,c).easing(TWEEN.Easing.Exponential.InOut).start();a&&(new TWEEN.Tween(this.controls.target)).to(a,c).easing(TWEEN.Easing.Exponential.InOut).start()},addBindingDomUI:function(a,b,c){this.bindingDomUI[a]={domID:a,meshName:b,offset:c}},bindDomUI:function(a){var b=this.findObjectByName(a.meshName);if(b&&b.geometry&&(b=b.geometry.boundingBox.center(),b.x+=a.offset.x,b.y+=a.offset.y,b.z+=a.offset.z,b=b.project(this.camera),a=document.getElementById(a.domID))){var c=(1-b.y)*this.container.offsetHeight/2+this.container.offsetTop-a.offsetHeight/2;a.style.left=((b.x+1)*this.container.offsetWidth/2+this.container.offsetLeft-a.offsetWidth/2).toFixed(0)+"px";a.style.top=c.toFixed(0)+"px"}},enable:function(){this.actived=!0;this.reszieScene();this.animate()},disable:function(){this.actived=!1},animate:function(){if(0!=this.actived){var a=this.clock.getDelta();TWEEN.update();this.stats&&this.stats.update();if(this.controls){var b=new THREE.Sphere;this.sceneBoundingBox.getBoundingSphere(b);var c=new THREE.Vector3;c.subVectors(this.controls.object.position,b.center);c=c.length();this.camera.near=Math.max(.1,c-b.radius);this.camera.far=Math.max(1E4,c+b.radius+1);this.camera.updateProjectionMatrix();this.controls.update()}for(key in this.bindingDomUI)this.bindDomUI(this.bindingDomUI[key]);this.mixer&&this.mixer.update(a);this.render();requestAnimationFrame(animateGlobal)}},render:function(){this.actived&&(this.scene.updateMatrixWorld(),this.skyboxCamera.rotation.copy(this.camera.rotation),this.renderer.clear(),this.renderer.render(this.skyboxScene,this.skyboxCamera),this.renderer.render(this.scene,this.camera),this.renderer.render(this.sceneHelpers,this.camera))},reszieScene:function(){"function"===typeof this.controls.handleResize&&this.controls.handleResize();this.camera.aspect=this.container.offsetWidth/this.container.offsetHeight;this.camera.updateProjectionMatrix();this.skyboxCamera.aspect=this.container.offsetWidth/this.container.offsetHeight;this.skyboxCamera.updateProjectionMatrix();this.renderer.setSize(this.container.offsetWidth,this.container.offsetHeight);this.render()},setSceneSize:function(a,b){"function"===typeof this.controls.handleResize&&this.controls.handleResize();this.camera.aspect=a/b;this.camera.updateProjectionMatrix();this.skyboxCamera.aspect=window.innerWidth/window.innerHeight;this.skyboxCamera.updateProjectionMatrix();this.renderer.setSize(a,b)}};function QueryCamInfo(a){var b="";if(a=scene3D[a]){var b=b+("\u76f8\u673a\u4f4d\u7f6e:"+a.camera.position.x.toFixed(2)+","+a.camera.position.y.toFixed(2)+","+a.camera.position.z.toFixed(2)),b=b+("\r\n\u76ee\u6807\u4f4d\u7f6e:"+a.controls.target.x.toFixed(2)+","+a.controls.target.y.toFixed(2)+","+a.controls.target.z.toFixed(2)),b=b+("\r\n\u6700\u5c0f\u8ddd\u79bb:"+a.controls.minDistance.toFixed(2)),b=b+("\r\n\u6700\u5927\u8ddd\u79bb:"+a.controls.maxDistance.toFixed(2)),c=new THREE.Vector3;c.subVectors(a.controls.object.position,a.controls.target);b+="\r\n\u5f53\u524d\u8ddd\u79bb:"+c.length().toFixed(2)}return b}function QueryMeshInfo(a){var b="";a=a.split(".");if(2!=a.length)return b;var c=scene3D[a[0]];c&&(a=c.findObjectByName(a[1]))&&(c=a.geometry,b+="\u9876\u70b9\u4e2a\u6570:"+c.vertices.length,b+="\r\n\u4e09\u89d2\u9762\u4e2a\u6570:"+c.faces.length,b+="\r\nUV\u901a\u9053\u6570:"+c.faceVertexUvs.length+"\u5c42",b+="\r\n\u5305\u56f4\u5706\u4e2d\u5fc3\u70b9:"+c.boundingSphere.center.x.toFixed(2)+","+c.boundingSphere.center.y.toFixed(2)+","+c.boundingSphere.center.z.toFixed(2)+", \u534a\u5f84"+c.boundingSphere.radius.toFixed(2),b+="\r\n\u5305\u56f4\u76d2:"+c.boundingBox.min.x.toFixed(2)+","+c.boundingBox.min.y.toFixed(2)+","+c.boundingBox.min.z.toFixed(2)+" ~ "+c.boundingBox.max.x.toFixed(2)+","+c.boundingBox.max.y.toFixed(2)+","+c.boundingBox.max.z.toFixed(2),a=a.matrix.elements,b+="\r\n\u77e9\u9635:\r\n  "+a[0]+","+a[1]+","+a[2]+","+a[3]+",\r\n  "+a[4]+","+a[5]+","+a[6]+","+a[7]+",\r\n  "+a[8]+","+a[9]+","+a[10]+","+a[11]+",\r\n  "+a[12]+","+a[13]+","+a[14]+","+a[15]);return b}function _local_replaceColon(a){return a.replace(/:/g,"%3A")}function EMPLyuQuery(a){var b="QueryInfo:";a=a.split(":");if(3!=a.length)return"";"QueryCamInfo"==a[0]?(b+=a[0]+":",b+=_local_replaceColon(QueryCamInfo(a[1])),b+=":"+a[2]):"QueryMeshInfo"==a[0]&&(b+=a[0]+":",b+=_local_replaceColon(QueryMeshInfo(a[1])),b+=":"+a[2]);"function"==typeof MsgBuilder&&MsgBuilder(b)}function dom3dReszie(){for(var a in scene3D)scene3D[a].actived&&scene3D[a].reszieScene()}window.addEventListener("resize",dom3dReszie,!1);function animateGlobal(){for(var a in scene3D)scene3D[a].actived&&scene3D[a].animate()}function create3dScene(a,b,c,d,f,l){var g=scene3D[a];null==g&&(g=new EmpScene,g.initScene(a,l),scene3D[a]=g);g.setSceneSize(b,c);g.setClearColor(d,f);return g}THREE.FirstPersonControls=function(a,b){function c(a){a.preventDefault()}function d(a,b){return function(){b.apply(a,arguments)}}this.object=a;this.target=new THREE.Vector3(0,0,0);this.domElement=void 0!==b?b:document;this.enabled=!0;this.movementSpeed=1;this.lookSpeed=.005;this.lookVertical=!0;this.autoForward=!1;this.activeLook=!0;this.heightSpeed=!1;this.heightCoef=1;this.heightMin=0;this.heightMax=1;this.constrainVertical=!1;this.verticalMin=0;this.verticalMax=Math.PI;this.theta=this.phi=this.lon=this.lat=this.mouseY=this.mouseX=this.autoSpeedFactor=0;this.mouseDragOn=this.moveRight=this.moveLeft=this.moveBackward=this.moveForward=!1;this.viewHalfY=this.viewHalfX=0;this.domElement!==document&&this.domElement.setAttribute("tabindex",-1);this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)};this.onMouseDown=function(a){this.domElement!==document&&this.domElement.focus();a.preventDefault();a.stopPropagation();if(this.activeLook)switch(a.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0};this.onMouseUp=function(a){a.preventDefault();a.stopPropagation();if(this.activeLook)switch(a.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1};this.onMouseMove=function(a){this.domElement===document?(this.mouseX=a.pageX-this.viewHalfX,this.mouseY=a.pageY-this.viewHalfY):(this.mouseX=a.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=a.pageY-this.domElement.offsetTop-this.viewHalfY)};this.onKeyDown=function(a){switch(a.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}};this.onKeyUp=function(a){switch(a.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}};this.update=function(a){if(!1!==this.enabled){if(this.heightSpeed){var b=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=a*b*this.heightCoef}else this.autoSpeedFactor=0;b=a*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(b+this.autoSpeedFactor));this.moveBackward&&this.object.translateZ(b);this.moveLeft&&this.object.translateX(-b);this.moveRight&&this.object.translateX(b);this.moveUp&&this.object.translateY(b);this.moveDown&&this.object.translateY(-b);a*=this.lookSpeed;this.activeLook||(a=0);b=1;this.constrainVertical&&(b=Math.PI/(this.verticalMax-this.verticalMin));this.lon+=this.mouseX*a;this.lookVertical&&(this.lat-=this.mouseY*a*b);this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=THREE.Math.degToRad(90-this.lat);this.theta=THREE.Math.degToRad(this.lon);this.constrainVertical&&(this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));a=this.target;b=this.object.position;a.x=b.x+100*Math.sin(this.phi)*Math.cos(this.theta);a.y=b.y+100*Math.cos(this.phi);a.z=b.z+100*Math.sin(this.phi)*Math.sin(this.theta);this.object.lookAt(a)}};this.dispose=function(){this.domElement.removeEventListener("contextmenu",c,!1);this.domElement.removeEventListener("mousedown",l,!1);this.domElement.removeEventListener("mousemove",f,!1);this.domElement.removeEventListener("mouseup",g,!1);window.removeEventListener("keydown",k,!1);window.removeEventListener("keyup",h,!1)};var f=d(this,this.onMouseMove),l=d(this,this.onMouseDown),g=d(this,this.onMouseUp),k=d(this,this.onKeyDown),h=d(this,this.onKeyUp);this.domElement.addEventListener("contextmenu",c,!1);this.domElement.addEventListener("mousemove",f,!1);this.domElement.addEventListener("mousedown",l,!1);this.domElement.addEventListener("mouseup",g,!1);window.addEventListener("keydown",k,!1);window.addEventListener("keyup",h,!1);this.handleResize()};THREE.FlyControls=function(a,b){function c(a,b){return function(){b.apply(a,arguments)}}function d(a){a.preventDefault()}this.object=a;this.domElement=void 0!==b?b:document;b&&this.domElement.setAttribute("tabindex",-1);this.movementSpeed=1;this.rollSpeed=.005;this.autoForward=this.dragToLook=!1;this.tmpQuaternion=new THREE.Quaternion;this.mouseStatus=0;this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0};this.moveVector=new THREE.Vector3(0,0,0);this.rotationVector=new THREE.Vector3(0,0,0);this.handleEvent=function(a){if("function"==typeof this[a.type])this[a.type](a)};this.handleResize=function(){};this.keydown=function(a){if(!a.altKey){switch(a.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector();this.updateRotationVector()}};this.keyup=function(a){switch(a.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector();this.updateRotationVector()};this.mousedown=function(a){this.domElement!==document&&this.domElement.focus();a.preventDefault();a.stopPropagation();if(this.dragToLook)this.mouseStatus++;else{switch(a.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}};this.mousemove=function(a){if(!this.dragToLook||0<this.mouseStatus){var b=this.getContainerDimensions(),c=b.size[0]/2,d=b.size[1]/2;this.moveState.yawLeft=-(a.pageX-b.offset[0]-c)/c;this.moveState.pitchDown=(a.pageY-b.offset[1]-d)/d;this.updateRotationVector()}};this.mouseup=function(a){a.preventDefault();a.stopPropagation();if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(a.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()};this.update=function(a){var b=a*this.movementSpeed;a*=this.rollSpeed;this.object.translateX(this.moveVector.x*b);this.object.translateY(this.moveVector.y*b);this.object.translateZ(this.moveVector.z*b);this.tmpQuaternion.set(this.rotationVector.x*a,this.rotationVector.y*a,this.rotationVector.z*a,1).normalize();this.object.quaternion.multiply(this.tmpQuaternion);this.object.rotation.setFromQuaternion(this.object.quaternion,this.object.rotation.order)};this.updateMovementVector=function(){var a=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right;this.moveVector.y=-this.moveState.down+this.moveState.up;this.moveVector.z=-a+this.moveState.back};this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp;this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft;this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft};this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}};this.dispose=function(){this.domElement.removeEventListener("contextmenu",d,!1);this.domElement.removeEventListener("mousedown",l,!1);this.domElement.removeEventListener("mousemove",f,!1);this.domElement.removeEventListener("mouseup",g,!1);window.removeEventListener("keydown",k,!1);window.removeEventListener("keyup",h,!1)};var f=c(this,this.mousemove),l=c(this,this.mousedown),g=c(this,this.mouseup),k=c(this,this.keydown),h=c(this,this.keyup);this.domElement.addEventListener("contextmenu",d,!1);this.domElement.addEventListener("mousemove",f,!1);this.domElement.addEventListener("mousedown",l,!1);this.domElement.addEventListener("mouseup",g,!1);window.addEventListener("keydown",k,!1);window.addEventListener("keyup",h,!1);this.updateMovementVector();this.updateRotationVector()};THREE.OrbitControls=function(a,b){function c(){return Math.pow(.95,e.zoomSpeed)}function d(a){e.object instanceof THREE.PerspectiveCamera?B/=a:e.object instanceof THREE.OrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*a)),e.object.updateProjectionMatrix(),M=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function f(a){e.object instanceof THREE.PerspectiveCamera?B*=a:e.object instanceof THREE.OrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/a)),e.object.updateProjectionMatrix(),M=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function l(a){if(!1!==e.enabled){a.preventDefault();if(a.button===e.mouseButtons.ORBIT){if(!1===e.enableRotate)return;C.set(a.clientX,a.clientY);t=p.ROTATE}else if(a.button===e.mouseButtons.ZOOM){if(!1===e.enableZoom)return;D.set(a.clientX,a.clientY);t=p.DOLLY}else if(a.button===e.mouseButtons.PAN){if(!1===e.enablePan)return;E.set(a.clientX,a.clientY);t=p.PAN}t!==p.NONE&&(document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",k,!1),document.addEventListener("mouseout",k,!1),e.dispatchEvent(z))}}function g(a){!1!==e.enabled&&(a.preventDefault(),t===p.ROTATE?!1!==e.enableRotate&&(F.set(a.clientX,a.clientY),G.subVectors(F,C),a=e.domElement===document?e.domElement.body:e.domElement,w.theta-=2*Math.PI*G.x/a.clientWidth*e.rotateSpeed,w.phi-=2*Math.PI*G.y/a.clientHeight*e.rotateSpeed,C.copy(F),e.update()):t===p.DOLLY?!1!==e.enableZoom&&(H.set(a.clientX,a.clientY),I.subVectors(H,D),0<I.y?d(c()):0>I.y&&f(c()),D.copy(H),e.update()):t===p.PAN&&!1!==e.enablePan&&(J.set(a.clientX,a.clientY),K.subVectors(J,E),L(K.x,K.y),E.copy(J),e.update()))}function k(a){!1!==e.enabled&&(document.removeEventListener("mousemove",g,!1),document.removeEventListener("mouseup",k,!1),document.removeEventListener("mouseout",k,!1),e.dispatchEvent(y),t=p.NONE)}function h(a){if(!1!==e.enabled&&!1!==e.enableZoom&&t===p.NONE){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?f(c()):0>b&&d(c());e.update();e.dispatchEvent(z);e.dispatchEvent(y)}}function n(a){if(!1!==e.enabled&&!1!==e.enableKeys&&!1!==e.enablePan)switch(a.keyCode){case e.keys.UP:L(0,e.keyPanSpeed);e.update();break;case e.keys.BOTTOM:L(0,-e.keyPanSpeed);e.update();break;case e.keys.LEFT:L(e.keyPanSpeed,0);e.update();break;case e.keys.RIGHT:L(-e.keyPanSpeed,0),e.update()}}function r(a){if(!1!==e.enabled){switch(a.touches.length){case 1:if(!1===e.enableRotate)return;C.set(a.touches[0].pageX,a.touches[0].pageY);t=p.TOUCH_ROTATE;break;case 2:if(!1===e.enableZoom)return;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;D.set(0,Math.sqrt(b*b+a*a));t=p.TOUCH_DOLLY;break;case 3:if(!1===e.enablePan)return;E.set(a.touches[0].pageX,a.touches[0].pageY);t=p.TOUCH_PAN;break;default:t=p.NONE}t!==p.NONE&&e.dispatchEvent(z)}}function q(a){if(!1!==e.enabled)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:if(!1===e.enableRotate)break;if(t!==p.TOUCH_ROTATE)break;F.set(a.touches[0].pageX,a.touches[0].pageY);G.subVectors(F,C);var b=e.domElement===document?e.domElement.body:e.domElement;w.theta-=2*Math.PI*G.x/b.clientWidth*e.rotateSpeed;w.phi-=2*Math.PI*G.y/b.clientHeight*e.rotateSpeed;C.copy(F);e.update();break;case 2:if(!1===e.enableZoom)break;if(t!==p.TOUCH_DOLLY)break;b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;H.set(0,Math.sqrt(b*b+a*a));I.subVectors(H,D);0<I.y?f(c()):0>I.y&&d(c());D.copy(H);e.update();break;case 3:if(!1===e.enablePan)break;if(t!==p.TOUCH_PAN)break;J.set(a.touches[0].pageX,a.touches[0].pageY);K.subVectors(J,E);L(K.x,K.y);E.copy(J);e.update();break;default:t=p.NONE}}function m(a){!1!==e.enabled&&(e.dispatchEvent(y),t=p.NONE)}function u(a){a.preventDefault()}this.object=a;this.domElement=void 0!==b?b:document;this.enabled=!0;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=!1;this.dampingFactor=.25;this.enableZoom=!0;this.zoomSpeed=1;this.enableRotate=!0;this.rotateSpeed=1;this.enablePan=!0;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.enableKeys=!0;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return phi};this.getAzimuthalAngle=function(){return theta};this.reset=function(){e.target.copy(e.target0);e.object.position.copy(e.position0);e.object.zoom=e.zoom0;e.object.updateProjectionMatrix();e.dispatchEvent(x);e.update();t=p.NONE};this.update=function(){var b=new THREE.Vector3,c=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),d=c.clone().inverse(),f=new THREE.Vector3,g=new THREE.Quaternion;return function(){var a=e.object.position;b.copy(a).sub(e.target);b.applyQuaternion(c);v.setFromVector3(b);e.autoRotate&&t===p.NONE&&(w.theta-=2*Math.PI/60/60*e.autoRotateSpeed);v.theta+=w.theta;v.phi+=w.phi;v.theta=Math.max(e.minAzimuthAngle,Math.min(e.maxAzimuthAngle,v.theta));v.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,v.phi));v.makeSafe();v.radius*=B;v.radius=Math.max(e.minDistance,Math.min(e.maxDistance,v.radius));e.target.add(N);b.setFromSpherical(v);b.applyQuaternion(d);a.copy(e.target).add(b);e.object.lookAt(e.target);!0===e.enableDamping?(w.theta*=1-e.dampingFactor,w.phi*=1-e.dampingFactor):w.set(0,0,0);B=1;N.set(0,0,0);return M||f.distanceToSquared(e.object.position)>A||8*(1-g.dot(e.object.quaternion))>A?(e.dispatchEvent(x),f.copy(e.object.position),g.copy(e.object.quaternion),M=!1,!0):!1}}();this.dispose=function(){e.domElement.removeEventListener("contextmenu",u,!1);e.domElement.removeEventListener("mousedown",l,!1);e.domElement.removeEventListener("mousewheel",h,!1);e.domElement.removeEventListener("MozMousePixelScroll",h,!1);e.domElement.removeEventListener("touchstart",r,!1);e.domElement.removeEventListener("touchend",m,!1);e.domElement.removeEventListener("touchmove",q,!1);document.removeEventListener("mousemove",g,!1);document.removeEventListener("mouseup",k,!1);document.removeEventListener("mouseout",k,!1);window.removeEventListener("keydown",n,!1)};var e=this,x={type:"change"},z={type:"start"},y={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},t=p.NONE,A=1E-6,v=new THREE.Spherical,w=new THREE.Spherical,B=1,N=new THREE.Vector3,M=!1,C=new THREE.Vector2,F=new THREE.Vector2,G=new THREE.Vector2,E=new THREE.Vector2,J=new THREE.Vector2,K=new THREE.Vector2,D=new THREE.Vector2,H=new THREE.Vector2,I=new THREE.Vector2;this.handleResize=function(){};var O=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,0);a.multiplyScalar(-b);N.add(a)}}(),P=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,1);a.multiplyScalar(b);N.add(a)}}(),L=function(){var a=new THREE.Vector3;return function(b,c){var d=e.domElement===document?e.domElement.body:e.domElement;if(e.object instanceof THREE.PerspectiveCamera){a.copy(e.object.position).sub(e.target);var f=a.length(),f=f*Math.tan(e.object.fov/2*Math.PI/180);O(2*b*f/d.clientHeight,e.object.matrix);P(2*c*f/d.clientHeight,e.object.matrix)}else e.object instanceof THREE.OrthographicCamera?(O(b*(e.object.right-e.object.left)/e.object.zoom/d.clientWidth,e.object.matrix),P(c*(e.object.top-e.object.bottom)/e.object.zoom/d.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();e.domElement.addEventListener("contextmenu",u,!1);e.domElement.addEventListener("mousedown",l,!1);e.domElement.addEventListener("mousewheel",h,!1);e.domElement.addEventListener("MozMousePixelScroll",h,!1);e.domElement.addEventListener("touchstart",r,!1);e.domElement.addEventListener("touchend",m,!1);e.domElement.addEventListener("touchmove",q,!1);window.addEventListener("keydown",n,!1);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(a){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!a}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return!this.enableRotate},set:function(a){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!a}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(a){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!a}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return!this.enableKeys},set:function(a){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!a}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.constraint.enableDamping},set:function(a){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.constraint.enableDamping=!a}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.constraint.dampingFactor},set:function(a){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.constraint.dampingFactor=a}}});