<html>

<head>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/font-awesome.css">
    <link rel="stylesheet" href="/css/buttons.min.css">
    <link rel="stylesheet/less" type="text/css" href="/css/supplycell.less" />
    <link rel="stylesheet" href="/css/jquery.sidr.dark.min.css">
    <link rel="stylesheet" href="/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.css" />
    <script src="/jquery/dist/jquery.min.js"></script>
    <script src="/js/myTrick.js"></script>
    <script src="/js/vendor/bootstrap.min.js"></script>
    <script src="/hammerjs/hammer.min.js"></script>
    <script src="/interact/dist/interact.min.js"></script>
    <script src="/js/vendor/jquery.row-grid.js"></script>
    <script src="/js/vendor/echarts2.min.js"></script>
    <script src="/js/vendor/dataTool.min.js"></script>
    <script src="/js/vendor/jquery.sidr.min.js"></script>
    <script src="/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="/js/vendor/map/china.js"></script>
    <style>
    div {
        font-family: Microsoft YaHei;
    }
    
    .button5 {
        background-color: rgba(0, 0, 0, 0);
        color: #e9c165;
        border: 2px solid #555555;
        width: 120px;
        margin-top: 20px;
    }
    
    .button5:hover {
        background-color: #555555;
        color: #e9c165;
    }
    </style>
</head>
<style>
body {
    background-color: #161627;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
}
</style>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="row">
                    <div id="test-main" style="width: 100%;height: 100%;"></div>
                    <script type="text/javascript">
                    $(document).ready(function() {
                        // 基于准备好的dom，初始化echarts实例
                        var myChart = echarts.init(document.getElementById('test-main'));
                        var view = [{
                            name: '我',
                            href: '3Dmodels/clothWoman/'
                        }, {
                            name: '顾乡',
                            href: '3Dmodels/clothMan/'
                        }];

                        function findHrefbyName(view, name) {
                            for (var i = view.length - 1; i >= 0; i--) {
                                if (view[i].name == name) return view[i].href;
                            }
                            return false;
                        }
                        myChart.showLoading();
                        $.get('/les-miserables.gexf', function(xml) {
                            myChart.hideLoading();

                            var graph = echarts.dataTool.gexf.parse(xml);
                            var categories = [];
                            for (var i = 0; i < 9; i++) {
                                categories[i] = {
                                    name: '圈子' + i
                                };
                            }
                            graph.nodes.forEach(function(node) {
                                node.itemStyle = null;
                                node.value = node.symbolSize;
                                node.symbolSize /= 1.5;
                                node.label = {
                                    normal: {
                                        show: node.symbolSize > 30
                                    }
                                };
                                node.category = node.attributes.modularity_class;
                            });
                            option = {
                                baseOption: {
                                    title: {
                                        top: 'bottom',
                                        left: 'right'
                                    },
                                    tooltip: {},
                                    // legend: [{
                                    //     // selectedMode: 'single',
                                    //     data: categories.map(function (a) {
                                    //         return a.name;
                                    //     })
                                    // }],
                                    animationDuration: 5000,
                                    animationEasingUpdate: 'quinticInOut',
                                    series: [{
                                        name: '',
                                        type: 'graph',
                                        layout: 'none',
                                        data: graph.nodes,
                                        links: graph.links,
                                        categories: categories,
                                        roam: true,
                                        label: {
                                            normal: {
                                                position: 'right',
                                                formatter: '{b}'
                                            }
                                        },
                                        roam: true,
                                        focusNodeAdjacency: true,
                                        lineStyle: {
                                            normal: {
                                                color: 'source',
                                                curveness: 0.2
                                            }
                                        }
                                    }]
                                },
                                media: {
                                    option: {
                                        legend: {
                                            right: 'center',
                                            bottom: 0,
                                            orient: 'horizontal'
                                        },
                                        series: [{
                                            radius: [20, '50%'],
                                            center: ['50%', '50%']
                                        }]
                                    }
                                }
                            };

                            myChart.setOption(option);
                        }, 'xml');
                        myChart.on('click', function(params) {
                            if (params.componentType === 'markPoint') {
                                // 点击到了 markPoint 上
                                if (params.seriesIndex === 5) {
                                    // 点击到了 index 为 5 的 series 的 markPoint 上。
                                }
                            } else if (params.componentType === 'series') {
                                if (params.seriesType === 'graph') {
                                    if (params.dataType === 'edge') {
                                        // 点击到了 graph 的 edge（边）上。

                                    } else {
                                        // 点击到了 graph 的 node（节点）上。
                                        href = findHrefbyName(view, params.name);
                                        if (href) {
                                            window.location.href = href;
                                        }
                                    }
                                }
                            }

                        });
                    });
                    </script>
                </div>
            </div>
        </div>18910017930
    </div>
</body>

</html>
